



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Project documentation with Markdown.">
      
      
        <link rel="canonical" href="https://dengking.github.io/algorithm/Application/wikipedia-String/string-searching/Knuth–Morris–Pratt-algorithm/Knuth–Morris–Pratt-algorithm/">
      
      
        <meta name="author" content="DengKing">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.6.0">
    
    
      
        <title>Knuth–Morris–Pratt algorithm - algorithm</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/application.1b62728e.css">
      
      
    
    
      <script src="../../../../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../../../css/extra.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-27795084-5", "mkdocs.org")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://dengking.github.io/algorithm" title="algorithm" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              algorithm
            </span>
            <span class="md-header-nav__topic">
              
                Knuth–Morris–Pratt algorithm
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/dengking/algorithm" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://dengking.github.io/algorithm" title="algorithm" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    algorithm
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/dengking/algorithm" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Recursion
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Recursion
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Recursion(computer-science)/" title="Recursion(computer-science)" class="md-nav__link">
      Recursion(computer-science)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Recurrence-relation/" title="Recurrence-relation" class="md-nav__link">
      Recurrence-relation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Tower-of-Hanoi/" title="Tower-of-Hanoi" class="md-nav__link">
      Tower-of-Hanoi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Structural-induction/" title="Structural-induction" class="md-nav__link">
      Structural-induction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/VS-structural-recursion-VS-generative-recursion/" title="VS-structural-recursion-VS-generative-recursion" class="md-nav__link">
      VS-structural-recursion-VS-generative-recursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Corecursion/" title="Corecursion" class="md-nav__link">
      Corecursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/VS-recursion-VS-corecursion/" title="VS-recursion-VS-corecursion" class="md-nav__link">
      VS-recursion-VS-corecursion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Recursion-to-iteration/" title="Recursion-to-iteration" class="md-nav__link">
      Recursion-to-iteration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Recursion/Recursion-analysis-and-representation/" title="Recursion-analysis-and-representation" class="md-nav__link">
      Recursion-analysis-and-representation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Algorithm-design-paradigm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Algorithm-design-paradigm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Brute-force
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Brute-force
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/00-Brute-force/Brute-force-search/" title="Brute-force-search" class="md-nav__link">
      Brute-force-search
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Divide-and-Conquer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Divide-and-Conquer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/01-Divide-and-Conquer/Divide-and-conquer-algorithm/" title="Divide-and-conquer-algorithm" class="md-nav__link">
      Divide-and-conquer-algorithm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Dynamic-Programming&Greedy-Algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Dynamic-Programming&Greedy-Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Optimal-substructure/" title="Optimal-substructure" class="md-nav__link">
      Optimal-substructure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Bellman-equation/" title="Bellman-equation" class="md-nav__link">
      Bellman-equation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-4" type="checkbox" id="nav-3-4-4">
    
    <label class="md-nav__link" for="nav-3-4-4">
      Dynamic-Programming
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-4">
        Dynamic-Programming
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Dynamic-Programming/Dynamic-programming/" title="Dynamic-programming" class="md-nav__link">
      Dynamic-programming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Dynamic-Programming/Overlapping-subproblems/" title="Overlapping-subproblems" class="md-nav__link">
      Overlapping-subproblems
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Dynamic-Programming/VS-最长公共子序列-VS-矩阵连乘问题-VS-最大子段和/" title="VS-最长公共子序列-VS-矩阵连乘问题-VS-最大子段和" class="md-nav__link">
      VS-最长公共子序列-VS-矩阵连乘问题-VS-最大子段和
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Dynamic-Programming/Catalan/" title="Catalan" class="md-nav__link">
      Catalan
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Dynamic-Programming/Reading-list/" title="Reading-list" class="md-nav__link">
      Reading-list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Greedy-algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        Greedy-algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Greedy-algorithm/Greedy-algorithm/" title="Greedy-algorithm" class="md-nav__link">
      Greedy-algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Greedy-algorithm/Huffman-Coding/" title="Huffman-Coding" class="md-nav__link">
      Huffman-Coding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Greedy-algorithm/Reading-list/" title="Reading-list" class="md-nav__link">
      Reading-list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Optimization-summary/" title="Optimization-summary" class="md-nav__link">
      Optimization-summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/02-Dynamic-Programming&Greedy-Algorithm/Dynamic-programming-VS-search-algorithm-VS-greedy-algorithm/" title="Dynamic-programming-VS-search-algorithm-VS-greedy-algorithm" class="md-nav__link">
      Dynamic-programming-VS-search-algorithm-VS-greedy-algorithm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Backtracking
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Backtracking
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Backtracking/" title="Backtracking" class="md-nav__link">
      Backtracking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Sudoku-solving-algorithms/" title="Sudoku-solving-algorithms" class="md-nav__link">
      Sudoku-solving-algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-3" type="checkbox" id="nav-3-5-3">
    
    <label class="md-nav__link" for="nav-3-5-3">
      Permutation-and-combination
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-3">
        Permutation-and-combination
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Permutation-and-combination/Permutation/" title="Permutation" class="md-nav__link">
      Permutation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5-3-2" type="checkbox" id="nav-3-5-3-2">
    
    <label class="md-nav__link" for="nav-3-5-3-2">
      Enum-permutation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-5-3-2">
        Enum-permutation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Permutation-and-combination/Enum-permutation/Backtrack-enum-all-permutations-of-string/" title="Backtrack-enum-all-permutations-of-string" class="md-nav__link">
      Backtrack-enum-all-permutations-of-string
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Permutation-and-combination/Enum-permutation/Enum-distinct-permutation-of-with-duplicate/" title="Enum-distinct-permutation-of-with-duplicate" class="md-nav__link">
      Enum-distinct-permutation-of-with-duplicate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Permutation-and-combination/Enum-permutation/Enum-permutation-reading-list/" title="Enum-permutation-reading-list" class="md-nav__link">
      Enum-permutation-reading-list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Permutation-and-combination/Reading-list/" title="Reading-list" class="md-nav__link">
      Reading-list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/05-Backtracking/Reading-list/" title="Reading-list" class="md-nav__link">
      Reading-list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Branch-and-Bound-Algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Branch-and-Bound-Algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/06-Branch-and-Bound-Algorithm/Branch-and-bound/" title="Branch-and-bound" class="md-nav__link">
      Branch-and-bound
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/06-Branch-and-Bound-Algorithm/Branch-and-cut/" title="Branch-and-cut" class="md-nav__link">
      Branch-and-cut
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Heuristic
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        Heuristic
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/Heuristic/Heuristic(computer-science)/" title="Heuristic(computer-science)" class="md-nav__link">
      Heuristic(computer-science)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/Heuristic/Heuristic-algorithms/" title="Heuristic-algorithms" class="md-nav__link">
      Heuristic-algorithms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/Heuristic/Heuristic-algorithm-reading-list/" title="Heuristic-algorithm-reading-list" class="md-nav__link">
      Heuristic-algorithm-reading-list
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-design-paradigm/Brute-force-VS-backtrack/" title="Brute-force-VS-backtrack" class="md-nav__link">
      Brute-force-VS-backtrack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Analysis-of-algorithms
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Analysis-of-algorithms
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Analysis-of-algorithms/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../Analysis-of-algorithms/Combinatorial-explosion/" title="Combinatorial-explosion" class="md-nav__link">
      Combinatorial-explosion
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../Algorithm-and-math/" title="Algorithm-and-math" class="md-nav__link">
      Algorithm-and-math
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Application
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Application
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../Computational-problem/" title="Computational-problem" class="md-nav__link">
      Computational-problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      Search
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        Search
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../search/Search-algorithm/" title="Search-algorithm" class="md-nav__link">
      Search-algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-2" type="checkbox" id="nav-6-2-2">
    
    <label class="md-nav__link" for="nav-6-2-2">
      Graph-and-tree-search-algorithm
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-2-2">
        Graph-and-tree-search-algorithm
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../search/Graph-and-tree-search-algorithm/A-star-search-algorithm/" title="A-star-search-algorithm" class="md-nav__link">
      A-star-search-algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../search/Graph-and-tree-search-algorithm/B-star-search-algorithm/" title="B-star-search-algorithm" class="md-nav__link">
      B-star-search-algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../search/Graph-and-tree-search-algorithm/Beam-search/" title="Beam-search" class="md-nav__link">
      Beam-search
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../search/Graph-and-tree-search-algorithm/Iterative-deepening-depth-first-search/" title="Iterative-deepening-depth-first-search" class="md-nav__link">
      Iterative-deepening-depth-first-search
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      Sorting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        Sorting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../sorting/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3-2" type="checkbox" id="nav-6-3-2">
    
    <label class="md-nav__link" for="nav-6-3-2">
      Merge-sort
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-3-2">
        Merge-sort
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../sorting/merge-sorts/Merge-sort/" title="Merge-sort" class="md-nav__link">
      Merge-sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../sorting/merge-sorts/Merge-algorithm/" title="Merge-algorithm" class="md-nav__link">
      Merge-algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../sorting/merge-sorts/k-way-merge-algorithm/" title="K-way-merge-algorithm" class="md-nav__link">
      K-way-merge-algorithm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <div class="toc">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#1_knuthmorrispratt_algorithm">1. Knuth–Morris–Pratt algorithm</a></li>
<li><a href="#2_kmp">2. 详解KMP算法</a><ul>
<li><a href="#next">求解next数组</a><ul>
<li><a href="#pk_pj">当P[k] == P[j]时</a></li>
<li><a href="#pk_pj_1">当P[k] != P[j]时,</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#3_computing_the_kmp_failure_function_fk">3. Computing the KMP failure function (f(k))</a><ul>
<li><a href="#definition_of_fk">definition of f(k)</a></li>
<li><a href="#naive_way_to_find_fk">Naive way to find f(k):</a></li>
<li><a href="#relating_fk_to_fk1">Relating f(k) to f(k−1)</a><ul>
<li><a href="#fact_between_fk_and_fk1">Fact between f(k) and f(k−1)</a></li>
<li><a href="#computation_trick_1">Computation trick 1</a></li>
<li><a href="#prelude_to_computation_trick_2">Prelude to computation trick 2</a></li>
<li><a href="#computation_trick_2">Computation trick #2</a></li>
</ul>
</li>
<li><a href="#algorithm_to_compute_kmp_failure_function">Algorithm to compute KMP failure function</a></li>
</ul>
</li>
<li><a href="#kmp">KMP实现分析</a><ul>
<li><a href="#kmp_failure_function">计算KMP failure function的递归公式</a></li>
<li><a href="#kmp_failure_functionpython">计算KMP failure function的python实现</a></li>
<li><a href="#kmp_failure_function_dynamic_programming">计算KMP failure function 和 dynamic programming</a></li>
<li><a href="#kmp_1">KMP的实现</a></li>
</ul>
</li>
<li><a href="#kmp_in_leetcode">KMP in leetcode</a></li>
</ul>
</div>
<h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">#</a></h1>
<p>It takes me some effort to master KMP algorithm. Here are three articles that helped me solve the mystery as I learned. </p>
<h1 id="1_knuthmorrispratt_algorithm">1. <a href="https://en.wikipedia.org/wiki/Knuth%E2%80%93Morris%E2%80%93Pratt_algorithm">Knuth–Morris–Pratt algorithm</a><a class="headerlink" href="#1_knuthmorrispratt_algorithm" title="Permanent link">#</a></h1>
<p>In <a href="https://en.wikipedia.org/wiki/Computer_science">computer science</a>, the <strong>Knuth–Morris–Pratt <a href="https://en.wikipedia.org/wiki/String-searching_algorithm">string-searching algorithm</a></strong> (or <strong>KMP algorithm</strong>) searches for occurrences of a "word" <code>W</code> within a main "text string" <code>S</code> by employing the observation that when a mismatch occurs, the word itself embodies sufficient information to determine where the next match could begin, thus bypassing re-examination of previously matched characters.</p>
<p>The <a href="https://en.wikipedia.org/wiki/Algorithm">algorithm</a> was conceived by <a href="https://en.wikipedia.org/wiki/James_H._Morris">James H. Morris</a> and independently discovered by <a href="https://en.wikipedia.org/wiki/Donald_Knuth">Donald Knuth</a> "a few weeks later" from automata theory.[<a href="https://en.wikipedia.org/wiki/Knuth–Morris–Pratt_algorithm#cite_note-knuth1977-1">1]</a>[<a href="https://en.wikipedia.org/wiki/Knuth–Morris–Pratt_algorithm#cite_note-2">2]</a> Morris and <a href="https://en.wikipedia.org/wiki/Vaughan_Pratt">Vaughan Pratt</a> published a technical report in 1970.[<a href="https://en.wikipedia.org/wiki/Knuth–Morris–Pratt_algorithm#cite_note-3">3]</a> The three also published the algorithm jointly in 1977.[<a href="https://en.wikipedia.org/wiki/Knuth–Morris–Pratt_algorithm#cite_note-knuth1977-1">1]</a> Independently, in 1969, <a href="https://en.wikipedia.org/wiki/Yuri_Matiyasevich">Matiyasevich</a>[<a href="https://en.wikipedia.org/wiki/Knuth–Morris–Pratt_algorithm#cite_note-4">4]</a>[<a href="https://en.wikipedia.org/wiki/Knuth–Morris–Pratt_algorithm#cite_note-5">5]</a> discovered a similar algorithm, coded by a two-dimensional Turing machine, while studying a string-pattern-matching recognition problem over a binary alphabet. This was the first linear-time algorithm for string matching.</p>
<h1 id="2_kmp">2. <a href="https://www.cnblogs.com/yjiyjige/p/3263858.html">详解KMP算法</a><a class="headerlink" href="#2_kmp" title="Permanent link">#</a></h1>
<p>KMP算法要解决的问题就是在字符串（也叫主串）中的模式（pattern）定位问题。说简单点就是我们平时常说的关键字搜索。模式串就是关键字（接下来称它为<code>P</code>），如果它在一个主串（接下来称为<code>T</code>）中出现，就返回它的具体位置，否则返回<code>-1</code>（常用手段）。</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083616-9b40c67ea22e449f813fb38fcfd3a4fb.png" /></p>
<p>首先，对于这个问题有一个很单纯的想法：从左到右一个个匹配，如果这个过程中有某个字符不匹配，就跳回去，将模式串向右移动一位。这有什么难的？</p>
<p>我们可以这样初始化：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083647-9dfd3e4a709c40dd98d9817927651960.png" /></p>
<p>之后我们只需要比较<strong><code>i</code>指针</strong>指向的字符和<strong><code>j</code>指针</strong>指向的字符是否一致。如果一致就都向后移动，如果不一致，如下图：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083659-e6718026bf4f48a0be2d5d6076be4c55.png" /> </p>
<p><code>A</code>和<code>E</code>不相等，那就把<strong><code>i</code>指针</strong>移回第1位（假设下标从0开始），<code>j</code>移动到模式串的第0位，然后又重新开始这个步骤：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083714-7de56d2c1cc84dbfa376cf410ba6f053.png" /></p>
<p>基于这个想法我们可以得到以下的程序：</p>
<pre><code class="java">/**

 * 暴力破解法

 * @param ts 主串

 * @param ps 模式串

 * @return 如果找到，返回在主串中第一个字符出现的下标，否则为-1

 */

public static int bf(String ts, String ps) {

    char[] t = ts.toCharArray();

    char[] p = ps.toCharArray();

    int i = 0; // 主串的位置

    int j = 0; // 模式串的位置

    while (i &lt; t.length &amp;&amp; j &lt; p.length) {

       if (t[i] == p[j]) { // 当两个字符相同，就比较下一个

           i++;

           j++;

       } else {

           i = i - j + 1; // 一旦不匹配，i后退

           j = 0; // j归0

       }

    }

    if (j == p.length) {

       return i - j;

    } else {

       return -1;

    }

}
</code></pre>

<p>上面的程序是没有问题的，但不够好！</p>
<blockquote>
<p>NOTE: geeksforgeeks的文章<a href="https://www.geeksforgeeks.org/naive-algorithm-for-pattern-searching/">Naive algorithm for Pattern Searching</a>中给出的代码是比上述代码更加容易理解的。 </p>
</blockquote>
<p>如果是人为来寻找的话，肯定不会再把<code>i</code>移动回第1位，<strong>因为主串匹配失败的位置前面除了第一个<code>A</code>之外再也没有<code>A</code></strong>了，我们为什么能知道主串前面只有一个<code>A</code>？<strong>因为我们已经知道前面三个字符都是匹配的！（这很重要）</strong>。移动过去肯定也是不匹配的！有一个想法，<code>i</code>可以不动，我们只需要移动<code>j</code>即可，如下图：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083828-cdb207f5460f4645982171e58571a741.png" /></p>
<p>上面的这种情况还是比较理想的情况，我们最多也就多比较了两次。但假如是在主串<code>SSSSSSSSSSSSSA</code>中查找<code>SSSSB</code>，比较到最后一个才知道不匹配，然后<code>i</code><strong>回溯</strong>，这个的效率是显然是最低的。</p>
<blockquote>
<p>NOTE: 关于回溯，参见<a href="https://en.wikipedia.org/wiki/Backtracking">Backtracking</a></p>
</blockquote>
<p>大牛们是无法忍受“暴力破解”这种低效的手段的，于是他们三个研究出了KMP算法。其思想就如同我们上边所看到的一样：“<strong>利用已经部分匹配这个有效信息，保持<code>i</code>指针不回溯，通过修改<code>j</code>指针，让模式串尽量地移动到有效的位置</strong>。”</p>
<blockquote>
<p>NOTE: 提醒你注意<strong>尽量地</strong>这个修饰语，等你完全理解了KMP算法，你就幡然醒悟这个修饰语是非常妙的。其实在这里，我是可以向你提前透露的，既然说是尽量，那么也就是说移动到的位置不一定是最最有效的位置，而是一个相对有效的位置，可能需要经过多次移动才能够到达正确的位置，毕竟计算机不是像我们人这样的智能。</p>
</blockquote>
<p>所以，整个KMP的重点就在于<strong>当某一个字符与主串不匹配时，我们应该知道<code>j</code>指针要移动到哪</strong>？</p>
<p>接下来我们自己来发现<code>j</code>的移动规律：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083912-49365b7e67cd4877b2f501074dae68d2.png" /></p>
<p>如图：<code>C</code>和<code>D</code>不匹配了，我们要把<code>j</code>移动到哪？显然是第1位。为什么？因为前面有一个<code>A</code>相同啊：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17083929-a9ccfb08833e4cf1a42c30f05608f8f5.png" /></p>
<p>如下图也是一样的情况：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084030-82e4b71b85a440c5a636d57503931415.png" /></p>
<p>可以把<code>j</code>指针移动到第2位，因为前面有两个字母是一样的：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084037-cc3c34200809414e9421c316ceba2cda.png" /></p>
<p>至此我们可以大概看出一点端倪，当匹配失败时，<code>j</code>要移动的下一个位置<code>k</code>。存在着这样的性质：<strong>最前面的<code>k</code>字符和<code>j</code>之前的最后<code>k</code>个字符是一样的</strong>。</p>
<p>如果用数学公式来表示是这样的</p>
<p><code>P[0 ~ k-1] == P[j-k ~ j-1]</code></p>
<p>这个相当重要，如果觉得不好记的话，可以通过下图来理解：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084056-66930855432b4357bafbf8d6c76c1840.png" /></p>
<p>弄明白了这个就应该可能明白为什么可以直接将<code>j</code>移动到<code>k</code>位置了。</p>
<p>因为:</p>
<p>当<code>T[i] != P[j]</code>时</p>
<p>有<code>T[i-j ~ i-1] == P[0 ~ j-1]</code></p>
<p>由<code>P[0 ~ k-1] == P[j-k ~ j-1]</code></p>
<p>必然：<code>T[i-k ~ i-1] == P[0 ~ k-1]</code></p>
<blockquote>
<p>NOTE: 上述公式其实就是a==b, b==c,则a==c</p>
</blockquote>
<p>公式很无聊，能看明白就行了，不需要记住。</p>
<blockquote>
<p>NOTE: 作者这里的总结不够直接，下面是摘自百度百科<a href="https://baike.baidu.com/item/kmp%E7%AE%97%E6%B3%95/10951804?fr=aladdin">kmp算法</a>中对这个结论的总结，它非常直接：</p>
<p>用暴力算法匹配字符串过程中，我们会把<code>T[0]</code> 跟 <code>W[0]</code> 匹配，如果相同则匹配下一个字符，直到出现不相同的情况，此时我们会丢弃前面的匹配信息，然后把<code>T[1]</code> 跟 <code>W[0]</code>匹配，循环进行，直到主串结束，或者出现匹配成功的情况。这种丢弃前面的匹配信息的方法，极大地降低了匹配效率。</p>
<p>而在KMP算法中，对于每一个模式串我们会事先计算出模式串的内部匹配信息，在匹配失败时最大的移动模式串，以减少匹配次数。</p>
<p>比如，在简单的一次匹配失败后，我们会想将模式串尽量的右移和主串进行匹配。右移的距离在KMP算法中是如此计算的：在<strong>已经匹配的模式串子串</strong>中，找出最长的相同的<a href="https://baike.baidu.com/item/前缀">前缀</a>和<a href="https://baike.baidu.com/item/后缀">后缀</a>，然后移动使它们重叠。</p>
</blockquote>
<p>这一段只是为了证明我们为什么可以直接将<code>j</code>移动到<code>k</code>而无须再比较前面的<code>k</code>个字符。</p>
<h2 id="next">求解next数组<a class="headerlink" href="#next" title="Permanent link">#</a></h2>
<p>好，接下来就是重点了，怎么求这个（这些）<code>k</code>呢？因为在<code>P</code>的每一个位置都可能发生不匹配，也就是说我们要计算每一个位置<code>j</code>对应的<code>k</code>，所以用一个数组<code>next</code>来保存，<code>next[j] = k</code>，表示当<code>T[i] != P[j]</code>时，<strong><code>j</code>指针</strong>的下一个位置。</p>
<p>很多教材或博文在这个地方都是讲得比较含糊或是根本就一笔带过，甚至就是贴一段代码上来，为什么是这样求？怎么可以这样求？根本就没有说清楚。而这里恰恰是整个算法最关键的地方。</p>
<pre><code class="java">public static int[] getNext(String ps) {

    char[] p = ps.toCharArray();

    int[] next = new int[p.length];

    next[0] = -1;

    int j = 0;

    int k = -1;

    while (j &lt; p.length - 1) {

       if (k == -1 || p[j] == p[k]) {

            next[++j] = ++k;

       } else {

           k = next[k];

       }

    }

    return next;

}
</code></pre>

<p>这个版本的求<code>next</code>数组的算法应该是流传最广泛的，代码是很简洁。可是真的很让人摸不到头脑，它这样计算的依据到底是什么？</p>
<p>好，先把这个放一边，我们自己来推导思路，现在要始终记住一点，<code>next[j]</code>的值（也就是<code>k</code>）表示，当<code>P[j] != T[i]</code>时，<code>j</code>指针的下一步移动位置。</p>
<p>先来看第一个：当<code>j</code>为0时，如果这时候不匹配，怎么办？</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084258-efd2e95d3644427ebc0304ed3d7adefb.png" /></p>
<p>像上图这种情况，<code>j</code>已经在最左边了，不可能再移动了，这时候要应该是<code>i</code>指针后移。所以在代码中才会有<code>next[0] = -1;</code>这个初始化。</p>
<blockquote>
<p>NOTE: 看了下面的完整的代码就知道为什么使用<code>-1</code>来作为初始值，因为<code>i++</code>和<code>j++</code>是在相同的分支中，<code>j++</code>后<code>j</code>为0，这就保证了从P的第一个元素开始匹配。</p>
</blockquote>
<p>如果是当<code>j</code>为1的时候呢？</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084310-29f9f8dbb6034151a383e7ccf6f5583e.png" /></p>
<p>显然，<code>j</code>指针一定是后移到0位置的。因为它前面也就只有这一个位置了。</p>
<p>下面这个是最重要的，请看如下图：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084327-8a3cdfab03094bfa9e5cace26796cae5.png" /> </p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084342-616036472ab546c082aa991004bb0034.png" /></p>
<p>请仔细对比这两个图。</p>
<p>我们发现一个规律：</p>
<h3 id="pk_pj">当<code>P[k] == P[j]</code>时<a class="headerlink" href="#pk_pj" title="Permanent link">#</a></h3>
<p>当<code>P[k] == P[j]</code>时，有<code>next[j+1] == next[j] + 1</code></p>
<p>其实这个是可以证明的：</p>
<p>因为在<code>P[j]</code>之前已经有<code>P[0 ~ k-1] == p[j-k ~ j-1]</code>。（<code>next[j] == k</code>）</p>
<p>这时候现有<code>P[k] == P[j]</code>，我们是不是可以得到<code>P[0 ~ k-1] + P[k] == p[j-k ~ j-1] + P[j]</code>。</p>
<p>即：<code>P[0 ~ k] == P[j-k ~ j]</code>，即<code>next[j+1] == k + 1 == next[j] + 1</code>。</p>
<p>这里的公式不是很好懂，还是看图会容易理解些。</p>
<h3 id="pk_pj_1">当<code>P[k] != P[j]</code>时,<a class="headerlink" href="#pk_pj_1" title="Permanent link">#</a></h3>
<p>当<code>P[k] != P[j]</code>时，如下图所示：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17122358-fd7e52dd382c4268a8ff52b85bff465d.png" /> </p>
<p>像这种情况，如果你从代码上看应该是这一句：<code>k = next[k];</code>为什么是这样子？你看下面应该就明白了。</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17122439-e349fed25e974e7886a27d18871ae48a.png" /></p>
<p>现在你应该知道为什么要<code>k = next[k]</code>了吧！像上边的例子，我们已经不可能找到<code>[ A，B，A，B ]</code>这个最长的后缀串了，但我们还是可能找到<code>[ A，B ]</code>、<code>[ B ]</code>这样的前缀串的。所以这个过程像不像在定位<code>[ A，B，A，C ]</code>这个串，当<code>C</code>和主串不一样了（也就是<code>k</code>位置不一样了），那当然是把指针移动到<code>next[k]</code>啦。</p>
<blockquote>
<p>NOTE: 这篇文章这里的分析还是比较难以理解的，下一篇在分析更加透彻。</p>
<p>NOTE: 构建<code>next</code>数组的算法是使用的数学归纳法来求解next数组的每个值，即根据<code>next</code>数组中前<code>j</code>个元素的值来求解<code>next[j+1]</code>的值。</p>
</blockquote>
<p>有了<code>next</code>数组之后就一切好办了，我们可以动手写KMP算法了：</p>
<pre><code class="java">public static int KMP(String ts, String ps) {

    char[] t = ts.toCharArray();

    char[] p = ps.toCharArray();

    int i = 0; // 主串的位置

    int j = 0; // 模式串的位置

    int[] next = getNext(ps);

    while (i &lt; t.length &amp;&amp; j &lt; p.length) {

       if (j == -1 || t[i] == p[j]) { // 当j为-1时，要移动的是i，当然j也要归0

           i++;

           j++;

       } else {

           // i不需要回溯了

           // i = i - j + 1;

           j = next[j]; // j回到指定位置

       }

    }

    if (j == p.length) {

       return i - j;

    } else {

       return -1;

    }

}
</code></pre>

<p>和暴力破解相比，就改动了4个地方。其中最主要的一点就是，<code>i</code>不需要回溯了。</p>
<p>最后，来看一下上边的算法存在的缺陷。来看第一个例子：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084712-f0d6998938764b309f61923452a2b20f.png" /> </p>
<p>显然，当我们上边的算法得到的<code>next</code>数组应该是<code>[ -1，0，0，1 ]</code></p>
<p>所以下一步我们应该是把<code>j</code>移动到第1个元素咯：</p>
<p><img alt="img" src="https://images0.cnblogs.com/blog/416010/201308/17084726-790fc1b2c48c411b8011eab9de692f6d.png" /></p>
<p>不难发现，<strong>这一步是完全没有意义的。因为后面的<code>B</code>已经不匹配了，那前面的<code>B</code>也一定是不匹配的</strong>，同样的情况其实还发生在第2个元素<code>A</code>上。</p>
<p>显然，<strong>发生问题的原因在于<code>P[j] == P[next[j]]</code></strong>。</p>
<p>所以我们也只需要添加一个判断条件即可：</p>
<pre><code class="java">public static int[] getNext(String ps) {

    char[] p = ps.toCharArray();

    int[] next = new int[p.length];

    next[0] = -1;

    int j = 0;

    int k = -1;

    while (j &lt; p.length - 1) {

       if (k == -1 || p[j] == p[k]) {

           if (p[++j] == p[++k]) { // 当两个字符相等时要跳过

              next[j] = next[k];

           } else {

              next[j] = k;

           }

       } else {

           k = next[k];

       }

    }

    return next;

}
</code></pre>

<p>该算法的实现是非常类似于动态规划算法的</p>
<p><code>next[j]</code>的值<code>k</code>就是<code>j</code>位之前的子串中，前缀集和后缀集中的最大重复子串的长度。</p>
<p><code>abacabac</code></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th>next[0]=-1;j=0;k=-1</th>
</tr>
</thead>
<tbody>
<tr>
<td>条件1</td>
<td>条件2</td>
<td>分支2</td>
<td>分支1</td>
</tr>
<tr>
<td>k==-1</td>
<td></td>
<td></td>
<td>next[1]=0;j=1;k=0</td>
</tr>
<tr>
<td></td>
<td>p[1]!=p[0];</td>
<td>k=next[0]=-1</td>
<td></td>
</tr>
<tr>
<td>k==-1</td>
<td></td>
<td></td>
<td>next[2]=0;j=2;k=0</td>
</tr>
<tr>
<td></td>
<td>p[2]==p[0];</td>
<td></td>
<td>next[3]=1;j=3;k=1</td>
</tr>
<tr>
<td></td>
<td>p[3]!=p[1];</td>
<td>k=next[1]=0</td>
<td></td>
</tr>
<tr>
<td></td>
<td>p[3]!=p[0];</td>
<td>k=next[0]=-1</td>
<td></td>
</tr>
<tr>
<td>k==-1;</td>
<td></td>
<td></td>
<td>next[4]=0;j=4;k=0</td>
</tr>
<tr>
<td></td>
<td>p[4]==p[0]</td>
<td></td>
<td>next[5]=1;j=5;k=1</td>
</tr>
<tr>
<td></td>
<td>p[5]==p[1]</td>
<td></td>
<td>next[6]=2;j=6;k=2</td>
</tr>
<tr>
<td></td>
<td>p[6]==p[2]</td>
<td></td>
<td>next[7]=3;j=7;k=3</td>
</tr>
<tr>
<td></td>
<td>p[7]==p[3]</td>
<td></td>
<td>next[8]=4;j=8;k=4</td>
</tr>
</tbody>
</table>
<p>要想得到<code>p[j+1]</code>，只需要比较<code>p[j]</code>和<code>p[k]</code>即可；</p>
<h1 id="3_computing_the_kmp_failure_function_fk">3. <a href="http://www.mathcs.emory.edu/~cheung/Courses/323/Syllabus/Text/Matching-KMP2.html">Computing the KMP failure function (f(k))</a><a class="headerlink" href="#3_computing_the_kmp_failure_function_fk" title="Permanent link">#</a></h1>
<h2 id="definition_of_fk">definition of <code>f(k)</code><a class="headerlink" href="#definition_of_fk" title="Permanent link">#</a></h2>
<pre><code>   f(k) = MaxOverlap ( &quot;p0 p1 ... pk&quot; )

   where:

      &quot;p0 p1 ... pk&quot; = the prefix of length k+1 of pattern P
</code></pre>

<p><strong>Graphically:</strong></p>
<p><img alt="img" src="http://www.mathcs.emory.edu/~cheung/Courses/323/Syllabus/Text/FIGS/KMP/KMP22.gif" /></p>
<h2 id="naive_way_to_find_fk">Naive way to find <strong><em>f(k)</em></strong>:<a class="headerlink" href="#naive_way_to_find_fk" title="Permanent link">#</a></h2>
<pre><code>   Given P = &quot;p0 p1 ... pm-1&quot;

   Given k = 1, 2, ..., m-1   (k = 0 ==&gt; f(0) = 0)

         1. Extract the sub-pattern:   &quot;p0 p1 ... pk&quot;

         2. Find the first (= largest) overlap:

             Try: (p0) p1 p2 ... pk-1
                       p0 p1 ... pk-1 pk

            If (no match)
             Try: (p0) p1 p2 ... pk-1
                          p0 p1 ... pk-1 pk

            And so on... The first overlap is the longest ! 
</code></pre>

<blockquote>
<p>NOTE: 上述算法是一个循环算法，即<code>for k in range(1, m)</code>，下面是上述算法的python实现：</p>
<p><code>python
def build_failure_table(p):
 """
 构建字符串p的最长公共前缀后缀数组
 :param p:
 :return:
 """
 failure_table = list()
 len_of_p = len(p)
 for len_of_sub_str in range(1, len_of_p + 1):
     max_len_of_overlap = int(len_of_sub_str / 2)  # 最大重叠前缀后缀的长度
     print("子串长度:{},最大重叠前缀后缀长度:{}".format(len_of_sub_str, max_len_of_overlap))
     if max_len_of_overlap == 0:
         # 长度为1的串，是没有重叠前缀后缀的
         failure_table.append(0)
     else:
         found = False  # 是否找到重叠前缀后缀
         for len_of_overlap in range(max_len_of_overlap, 0, -1):
             print("重叠前缀后缀长度:{}".format(len_of_overlap))
             # len_of_overlap 重叠前缀后缀的长度
             for prefix_index in range(len_of_overlap):
                 suffix_index = prefix_index + (len_of_sub_str - len_of_overlap)
                 print("前缀起始位置:{},后缀起始位置:{}".format(prefix_index, suffix_index))
                 if p[prefix_index] == p[suffix_index]:
                     if suffix_index == len_of_sub_str - 1:
                         # 找到了重叠部分
                         failure_table.append(len_of_overlap)
                         found = True
                         break
                 else:
                     break
             if found:
                 break
         if not found:
             failure_table.append(0)
 return failure_table</code></p>
</blockquote>
<h2 id="relating_fk_to_fk1">Relating <code>f(k)</code> to <code>f(k−1)</code><a class="headerlink" href="#relating_fk_to_fk1" title="Permanent link">#</a></h2>
<p>The values <code>f(k)</code> are computed easily using <strong>existing prefix overlap information</strong>:</p>
<ul>
<li><code>f(0) = 0</code> (<code>f(0)</code> is always 0)</li>
<li><code>f(1)</code> is computing using (already computed) value <code>f(0)</code></li>
<li><code>f(2)</code> is computing using (already computed) value <code>f(0)</code>, <code>f(1)</code></li>
<li><code>f(3)</code> is computing using (already computed) value <code>f(0)</code>, <code>f(1)</code>, <code>f(2)</code>
  And so on</li>
</ul>
<p>According to the definition of <code>f(k)</code>:</p>
<p><img alt="img" src="http://www.mathcs.emory.edu/~cheung/Courses/323/Syllabus/Text/FIGS/KMP/KMP23.gif" /></p>
<blockquote>
<p>NOTE: 上面这种表示问题的方式是比较容易理解的，即在原问题的基础上添加一个新元素从而构成了一个规模更大的问题。</p>
</blockquote>
<p>Suppose that we know that: <code>f(k−1) = x</code></p>
<p>In other words: the <strong>longest overlapping suffix and prefix</strong> in "<code>p0 p1 ... pk-1</code>" has <code>x</code> characters:</p>
<pre><code>                     f(k-1) = x characters               
                  &lt;-----------------------&gt;
      p1 p2 p3 ... pk-x-2 pk-x-3 pk-x-4 .... pk-1 
                       ^     ^     ^         ^
                       |     |     |  equal  |
                       v     v     v         v
                       p0    p1    p2 ....    px-1   px ... pk-1 
</code></pre>

<p><strong>question:</strong></p>
<p>Can we use the fact that f(k−1) = x to compute f(k) ?</p>
<p><strong>answer:</strong></p>
<p>Yes, because f(k) is computed using a similar prefix as f(k−1):</p>
<pre><code>    prefix used to compute f(k-1)
  +--------------------------------+
  |                                |
   p0   p1   p2 ....    px-1 ... pk-1  pk    
  |                                    |
  +------------------------------------+
      prefix used to compute f(k)
</code></pre>

<p>We will next learn how to exploit the similarity to compute f(k)</p>
<h3 id="fact_between_fk_and_fk1">Fact between <code>f(k)</code> and <code>f(k−1)</code><a class="headerlink" href="#fact_between_fk_and_fk1" title="Permanent link">#</a></h3>
<p><strong>Fact:</strong> f(k)   ≤   f(k−1) + 1</p>
<h3 id="computation_trick_1">Computation trick 1<a class="headerlink" href="#computation_trick_1" title="Permanent link">#</a></h3>
<p>Let use denote: <code>f(k−1) = x</code></p>
<p>(Note: <strong><code>f(k−1)</code></strong> is <strong>equal</strong> to <em>some</em> value. The <strong>above assumption</strong> simply gave a more convenient <strong><em>notation</em></strong> for this value).</p>
<p>If <code>px == pk</code>, then:</p>
<pre><code>   f(k) = x+1 

   (i.e., the maximum overlap of the prefix

                 p0   p1   p2 .... pk-1  pk    

     has x+1 characters 
</code></pre>

<p><strong>Proof:</strong></p>
<pre><code>
                   These x+1 characters match IF pk == px!               
                  &lt;----------------------------&gt;
      p1 p2 p3 ... pk-x-2 pk-x-3 pk-x-4 .... pk-1   pk
                   ^     ^     ^         ^     ^
                   |     |     |  equal  |     |equal
                   v     v     v         v     v
                   p0    p1    p2 ....       px-1   px ... pk-1  pk     
                  |                          |
              +--------------------------+
                   These characters matches
           because f(k-1) = x
</code></pre>

<h3 id="prelude_to_computation_trick_2">Prelude to computation trick 2<a class="headerlink" href="#prelude_to_computation_trick_2" title="Permanent link">#</a></h3>
<p>Consider the prefix <code>ababyabab</code> where f(8) = 4:</p>
<pre><code>
             012345678
    prefix = ababyabab

    f(8) = 4

    because:
               ababyabab
                    ababyabab                
                    &lt;--&gt;
                  4 characters overlap
</code></pre>

<p>We want to compute f(9) using f(8) , but now the next character does not match(that is the next char is not equal to y):</p>
<pre><code>             0123456789
    prefix = ababyababa

             ababyababa
          ababyababa  

    Conclusion:

       *** We CANNOT use f(8) to compute f(9) ***  
</code></pre>

<p><strong>question:</strong></p>
<ul>
<li>What should we try next to find the maximum overlap for the prefix "ababyababa"</li>
</ul>
<p><strong>answer:</strong></p>
<p>To find the maximum overlap, we must slide the prefix down and look for matching letters !!!</p>
<blockquote>
<p>NOTE: 思路是使用已经匹配的字符串来尽可能减少匹配次数并且寻找第一个最可能的位置。</p>
</blockquote>
<p>Now, let us use only the matching prefix information:</p>
<pre><code>      ababyababa
           ababyababa  


 Look only at these characters:               

      ?????abab?
           abab??????
</code></pre>

<p>We can know for sure that the overlap cannot be found starting at these positions:</p>
<pre><code>
      ?????abab?
            abab??????   
</code></pre>

<blockquote>
<p>NOTE: 因为我们知道串<code>abab</code>的最长公共前缀后缀的长度是2，即<code>f(3)</code>，所以它的前两个元素可以匹配上的，所以第一个可能位置是如下图所示的，这就是对已经匹配信息的充分运用。至于第三个元素是否能够匹配上，就要比较的结果了。</p>
</blockquote>
<p>The first possible way that overlap can be found is starting here:</p>
<pre><code>
      ?????abab?
             abab??????   
</code></pre>

<p>In other words: we can compute <code>f(9)</code> using <code>f(3)</code> :</p>
<pre><code>             0123
    prefix = abab

             abab
           abab         

    f(3) = 2
</code></pre>

<p>Notice that: 3 = 4−1 and f(8) = 4</p>
<p>Worked out further:</p>
<pre><code>             0123456789
    prefix = ababyababa

             ababyababa
                    ababyababa  
                      ^
                      |
          compare the character at position 2 (f(3) = 2)     

    Note:

       The prefix abab is hightlighted in yellow 
</code></pre>

<p>Because the characters are equal, we have found the maximum overlap:</p>
<pre><code>
     f(9) = f(3) + 1 
          =  2   + 1 
      =  3           !!!  
</code></pre>

<blockquote>
<p>NOTE:  这里可以假设，如果<code>p[3]</code>和<code>p[9]</code>并不相等，则上述流程需要继续下去，至于终止条件，显然是直至比较到第一个元素都不相等。</p>
</blockquote>
<h3 id="computation_trick_2">Computation trick #2<a class="headerlink" href="#computation_trick_2" title="Permanent link">#</a></h3>
<p>Let: f(k−1) = x</p>
<p>(Note: <strong><code>f(k−1)</code></strong> is <strong>equal</strong> to <em>some</em> value. The <strong>above assumption</strong> simply gave a more convenient <strong><em>notation</em></strong> for this value).</p>
<p>If <code>px ≠ pk</code>, then:</p>
<p>The next prefix that can be used to compute f(k) is:</p>
<pre><code>p0 p1 .... px-1
</code></pre>

<p>In pseudo code:</p>
<pre><code>    i = k-1;       // Try to use f(k-1) to compute f(k)
    x = f(i);      // x = character position to match against pk    

    if  ( P[k] == P[x] )  then     

        f(k) = f(x−1) + 1

    else

        Use:  p0 p1 .... px-1 to compute f(k)

        What that means in terms of program statements:

       i = x-1;    // Try to use f(x-1) to compute f(k) 
       x = f(i);   // x = character position to match against pk
</code></pre>

<p><strong>Note:</strong> We must repeat trick #2 as long as i ≥ 0, In other words: use a <code>while</code> loop instead of an <code>if</code> statement !</p>
<h2 id="algorithm_to_compute_kmp_failure_function">Algorithm to compute KMP failure function<a class="headerlink" href="#algorithm_to_compute_kmp_failure_function" title="Permanent link">#</a></h2>
<p><strong>Java code:</strong></p>
<pre><code class="java">   public static int[] KMP_failure_function(String P)
   {
      int k, i, x, m;
      int f[] = new int[P.length()];

      m = P.length();

      f[0] = 0;            // f(0) is always 0

      for ( k = 1; k &lt; m; k++ )
      {
         // Compute f[k]

         i = k-1;           // First try to use f(k-1) to compute f(k)
         x = f[i];

         while ( P.charAt(x) != P.charAt(k) )
         {
            i = x-1;        // Try the next candidate f(.) to compute f(k)     

            if ( i &lt; 0 )    // Make sure x is valid
               break;       // STOP the search !!!

            x = f[i];
         }


         if ( i &lt; 0  )
            f[k] = 0;          // No overlap at all: max overlap = 0 characters
         else
            f[k] = f[i] + 1;   // We can compute f(k) using f(i)
      }

      return(f);
   }
</code></pre>

<p>完整测试程序</p>
<pre><code class="java">/* ----------------------------------
   My own KMP Failure function alg

     S.Y. Cheung - 3/3/2013
   ---------------------------------- */

import java.util.*;

public class ComputeF
{
   public static int[] KMP_failure_function(String P)
   {
      int k, i, x, m;
      int f[] = new int[P.length()];

      String s;

      m = P.length();

      f[0] = 0;

      for ( k = 1; k &lt; m; k++ )
      {
         // Compute f[k]

         s = P.substring(0,k+1);
         System.out.println(&quot;-----------------------------------------------&quot;);
         System.out.println(&quot;Prefix = &quot; + s + &quot; --- Computing f(&quot;+k+&quot;):&quot;);

         i = k-1;           // First try to use f(k-1) to compute f(k)
         x = f[i];

         System.out.println(&quot;===================================&quot;);
         System.out.println(&quot;Try using: f(&quot; + i + &quot;) = &quot; + x );
         printState(s, s, k, x);

         while ( P.charAt(x) != P.charAt(k) )
         {
        i = f[i]-1;     // Try the next candidate f(.) to compute f(k)

        if ( i &lt; 0 )    // Search ended in failure....
           break;

            x = f[i];

            System.out.println(&quot;===================================&quot;);
            System.out.println(&quot;Try using: f(&quot; + i + &quot;) = &quot; + x );
            printState(s, s, k, x);
         }

         if ( i &lt; 0 )
         {
            System.out.println(&quot;No overlap possible... --&gt; f[&quot;+k+&quot;] = 0&quot;);
            f[k] = 0;          // No overlap possible
         }
         else
         {
            f[k] = f[i] + 1;   // Compute f(k) using f(i)

            System.out.println(&quot;Overlap found ... --&gt; f[&quot;+k+&quot;] = &quot;+f[k]);
         }
      }

      return(f);
   }


   public static void main(String[] args)
   {
      String P;
      Scanner in;
      int[] f;


      in = new Scanner( System.in );

      System.out.print(&quot;P = &quot;);
      P = in.nextLine();
      System.out.println();

      f = KMP_failure_function(P);

      for (int i = 0; i &lt; P.length(); i++ )
      {
         System.out.println(&quot;f(&quot;+i+&quot;) = &quot; + f[i]);
      }

      System.out.println();
   }



   /* =====================================================
      Variables and Methods to make the algorithm visual
      ===================================================== */
   public static String T_ruler, P_ruler;

   public static String ruler(int n)
   {
      String out = &quot;&quot;;
      char   x = '0';

      for ( int i = 0; i &lt; n; i++ )
      {
         out = out + x;
     x++;
     if ( x &gt; '9' )
        x = '0';
      }

      return out;
   }

   public static void printState(String T, String P, int i, int j)
   {
      T_ruler = ruler( T.length() );

      P_ruler = ruler( P.length() );

      System.out.println(&quot;=====================================&quot;);
      System.out.println(&quot;Matching: i = &quot; + i + &quot;, j = &quot; + j);

      System.out.println(&quot;   &quot; + T_ruler );
      System.out.println(&quot;   &quot; + T);
      System.out.print(&quot;   &quot;);
      for ( int k = 0; k &lt; i-j; k++)
         System.out.print(&quot; &quot;);
      System.out.println(P);

      System.out.print(&quot;   &quot;);
      for ( int k = 0; k &lt; i-j; k++)
         System.out.print(&quot; &quot;);
      System.out.println( P_ruler );

      System.out.print(&quot;   &quot;);
      for ( int k = 0; k &lt; i; k++)
         System.out.print(&quot; &quot;);
      System.out.println(&quot;^&quot;);

      System.out.print(&quot;   &quot;);
      for ( int k = 0; k &lt; i; k++)
         System.out.print(&quot; &quot;);
      System.out.println(&quot;|&quot;);
      System.out.println();
   }
}
</code></pre>

<h1 id="kmp">KMP实现分析<a class="headerlink" href="#kmp" title="Permanent link">#</a></h1>
<p>通过上述三篇文章，能够知道KMP算法的原理，现在需要考虑的是如何来进行实现。</p>
<h2 id="kmp_failure_function">计算KMP failure function的递归公式<a class="headerlink" href="#kmp_failure_function" title="Permanent link">#</a></h2>
<p>当<code>pattern[j]</code>与<code>pattern[f[j-1]]</code>不相等的时候，这个递归公式中涉及到了不断地循环递归，使用数学公式不方便描述，下面的python程序是非常简洁易懂的，并且是非常接近数学公式的，所以这里就省略掉递归公式。</p>
<h2 id="kmp_failure_functionpython">计算KMP failure function的python实现<a class="headerlink" href="#kmp_failure_functionpython" title="Permanent link">#</a></h2>
<p>failure function <code>f(j)</code>表示的是从<code>pattern[0]</code>到<code>pattern[j]</code>的序列（显然这个序列的长度是<code>j+1</code>）的最长公共前缀后缀的<strong>长度</strong>，即<code>f(j)</code>所表示的是长度为<code>j+1</code>的序列的最长公共前缀后缀的长度。显然<code>f[0]==0</code>，因为长度为1的序列的最长前缀后缀的长度为0。所以，当已知序列的长度为<code>i</code>，来查询其最长公共前缀后缀的时候，使用的是<code>f(i-1)</code>。因为<code>i</code>表示的是长度，所以<code>pattern[i]</code>引用的是数组的第<code>i+1</code>个元素。</p>
<pre><code class="python">def get_failure_array(pattern):
    failure = [0] # 初始条件
    i = 0 # f(j-1)的值，是已知的，需要注意的是，它的含义是长度
    j = 1 # f(j)是未知的，j表示的是index
    while j &lt; len(pattern):
        if pattern[i] == pattern[j]:
            i += 1
        elif i &gt; 0:
            i = failure[i - 1]
            continue
        j += 1
        failure.append(i)
    return failure
</code></pre>

<h2 id="kmp_failure_function_dynamic_programming">计算KMP failure function 和 dynamic programming<a class="headerlink" href="#kmp_failure_function_dynamic_programming" title="Permanent link">#</a></h2>
<p>KMP的failure function的求解过程在计算<code>f(k+1)</code>的时所依赖的<code>f(0),f(1)...,f(k)</code>都是通过查failure table而获得的，而不是重新计算，这其实就是动态规划算法的思想。在上述代码中，<code>i</code>就表示计算<code>f(k+1)</code>所依赖的数据，它的实现方式是非常类似于迭代版的斐波那契数列。</p>
<h2 id="kmp_1">KMP的实现<a class="headerlink" href="#kmp_1" title="Permanent link">#</a></h2>
<pre><code class="python">def kmp_search(pattern, text):
    &quot;&quot;&quot;

    :param pattern:
    :param text:
    :return:
    &quot;&quot;&quot;
    # 1) Construct the failure array
    failure = get_failure_array(pattern)

    # 2) Step through text searching for pattern
    i, j = 0, 0  # index into text, pattern
    while i &lt; len(text):
        if pattern[j] == text[i]:
            if j == (len(pattern) - 1):
                return True
            j += 1
        elif j &gt; 0:
            # if this is a prefix in our pattern
            # just go back far enough to continue
            j = failure[j - 1]
            continue
        i += 1
    return False
</code></pre>

<p>思考：为什么<code>j = failure[j - 1]</code>？其实结合前面的例子就可以知道了，这里不再赘述。</p>
<h1 id="kmp_in_leetcode">KMP in leetcode<a class="headerlink" href="#kmp_in_leetcode" title="Permanent link">#</a></h1>
<p>http://www.voidcn.com/article/p-uuefgkai-bnw.html</p>
<p>https://leetcode-cn.com/problems/implement-strstr/comments/</p>
<p>https://leetcode.com/problems/shortest-palindrome/discuss/60113/clean-kmp-solution-with-super-detailed-explanation</p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../../assets/javascripts/application.808e90bb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../../.."}})</script>
      
    
  </body>
</html>